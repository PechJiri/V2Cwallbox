{
  "_comment": "This file is generated. Please edit .homeycompose/app.json instead.",
  "id": "com.v2c.wallbox",
  "version": "1.0.1",
  "compatibility": ">=12.0.0",
  "sdk": 3,
  "brandColor": "#00275b",
  "platforms": [
    "local"
  ],
  "name": {
    "en": "V2C Wallbox"
  },
  "description": {
    "en": "The app allows you to monitor your V2C Wallbox online, retrieve complete data on charging progress, vehicle connection, and more, and control other devices in your home through flows based on this data."
  },
  "category": [
    "energy"
  ],
  "tags": {
    "en": [
      "v2c",
      "wallbox",
      "charger",
      "electric vehicle",
      "ev",
      "energy"
    ]
  },
  "permissions": [],
  "icon": "/assets/icon.svg",
  "images": {
    "small": "/assets/images/small.png",
    "large": "/assets/images/large.png",
    "xlarge": "/assets/images/xlarge.png"
  },
  "author": {
    "name": "Jiri Pech",
    "email": "jiri.pech@centrum.cz"
  },
  "contributing": {
    "donate": {
      "paypal": {
        "username": "pechjiri"
      }
    }
  },
  "source": "https://github.com/PechJiri/V2Cwallbox",
  "homepage": "https://v2charge.com/",
  "support": "mailto:jiri.pech@centrum.cz",
  "flow": {
    "triggers": [
      {
        "type": "trigger",
        "title": {
          "en": "Car is connected"
        },
        "id": "car-connected",
        "capabilities": [
          "measure_charge_state"
        ],
        "args": [],
        "condition": {
          "type": "function",
          "js": "function() { return device.state.measure_charge_state === '1'; }"
        },
        "description": {
          "en": "This flow triggers when the car is connected to the Wallbox."
        }
      },
      {
        "type": "trigger",
        "title": {
          "en": "Car starts charging"
        },
        "id": "car-start-charging",
        "capabilities": [
          "measure_charge_state"
        ],
        "args": [],
        "condition": {
          "type": "function",
          "js": "function() { return device.state.measure_charge_state === '2'; }"
        },
        "description": {
          "en": "This flow triggers when the car starts charging at the Wallbox."
        }
      },
      {
        "id": "power-becomes-greater-than",
        "type": "trigger",
        "title": {
          "en": "Power becomes greater than"
        },
        "titleFormatted": {
          "en": "Power becomes greater than [[power]] W"
        },
        "args": [
          {
            "type": "number",
            "name": "power",
            "title": {
              "en": "Power (W)"
            },
            "min": 0,
            "step": 1,
            "placeholder": {
              "en": "Enter power in watts"
            }
          }
        ],
        "capabilities": [
          "measure_power"
        ],
        "validate": {
          "en": "power > argument"
        },
        "description": {
          "en": "This trigger is activated when the power becomes greater than the specified value."
        }
      },
      {
        "id": "power-becomes-less-than",
        "type": "trigger",
        "title": {
          "en": "Power becomes less than"
        },
        "titleFormatted": {
          "en": "Power becomes less than [[power]] W"
        },
        "args": [
          {
            "type": "number",
            "name": "power",
            "title": {
              "en": "Power (W)"
            },
            "min": 0,
            "step": 1,
            "placeholder": {
              "en": "Enter power in watts"
            }
          }
        ],
        "capabilities": [
          "measure_power"
        ],
        "validate": {
          "en": "power < argument"
        },
        "description": {
          "en": "This trigger is activated when the power becomes less than the specified value."
        }
      }
    ],
    "conditions": [
      {
        "type": "condition",
        "title": {
          "en": "Car is connected"
        },
        "id": "car-connected-condition",
        "capabilities": [
          "measure_charge_state"
        ],
        "args": [],
        "validate": {
          "type": "function",
          "js": "function() { return device.state.measure_charge_state === '1'; }",
          "error": {
            "en": "The car is not connected."
          }
        },
        "description": {
          "en": "This condition is true when the car is connected to the Wallbox."
        }
      },
      {
        "type": "condition",
        "title": {
          "en": "Car is charging"
        },
        "id": "car-is-charging",
        "capabilities": [
          "measure_charge_state"
        ],
        "args": [],
        "validate": {
          "type": "function",
          "js": "function() { return device.state.measure_charge_state === '2'; }",
          "error": {
            "en": "The car is not charging."
          }
        },
        "description": {
          "en": "This condition is true when the car is currently charging at the Wallbox."
        }
      },
      {
        "id": "power-is-greater-than",
        "type": "condition",
        "title": {
          "en": "Power is greater than"
        },
        "titleFormatted": {
          "en": "Power is greater than [[power]] W"
        },
        "args": [
          {
            "type": "number",
            "name": "power",
            "title": {
              "en": "Power (W)"
            },
            "min": 0,
            "step": 1,
            "placeholder": {
              "en": "Enter power in watts"
            }
          }
        ],
        "capabilities": [
          "measure_power"
        ],
        "validate": {
          "en": "power > argument"
        },
        "description": {
          "en": "This condition is true when the power (W) is greater than the specified value."
        }
      },
      {
        "id": "power-is-less-than",
        "type": "condition",
        "title": {
          "en": "Power is less than"
        },
        "titleFormatted": {
          "en": "Power is less than [[power]] W"
        },
        "args": [
          {
            "type": "number",
            "name": "power",
            "title": {
              "en": "Power (W)"
            },
            "min": 0,
            "step": 1,
            "placeholder": {
              "en": "Enter power in watts"
            }
          }
        ],
        "capabilities": [
          "measure_power"
        ],
        "validate": {
          "en": "power < argument"
        },
        "description": {
          "en": "This condition is true when the power (W) is less than the specified value."
        }
      }
    ]
  },
  "drivers": [
    {
      "id": "v2c-wallbox",
      "name": {
        "en": "V2C Wallbox"
      },
      "class": "evcharger",
      "capabilities": [
        "measure_charge_state",
        "measure_charge_power",
        "measure_voltage_installation",
        "measure_charge_energy",
        "measure_slave_error",
        "measure_charge_time",
        "measure_paused",
        "measure_locked",
        "measure_intensity",
        "measure_dynamic"
      ],
      "capabilitiesOptions": {
        "measure_charge_power": {
          "title": {
            "en": "Current charging power"
          },
          "units": {
            "en": "W"
          }
        },
        "measure_charge_state": {
          "title": {
            "en": "Charge State"
          }
        },
        "measure_voltage_installation": {
          "title": {
            "en": "Voltage Installation"
          },
          "units": {
            "en": "V"
          }
        },
        "measure_charge_energy": {
          "title": {
            "en": "Charged Energy"
          },
          "units": {
            "en": "kWh"
          }
        },
        "measure_slave_error": {
          "title": {
            "en": "Communication Error"
          }
        },
        "measure_charge_time": {
          "title": {
            "en": "Car Connected Time"
          },
          "units": {
            "en": "min"
          }
        },
        "measure_paused": {
          "title": {
            "en": "Paused"
          }
        },
        "measure_locked": {
          "title": {
            "en": "Locked"
          }
        },
        "measure_intensity": {
          "title": {
            "en": "Intensity"
          },
          "units": {
            "en": "A"
          }
        },
        "measure_dynamic": {
          "title": {
            "en": "Dynamic"
          }
        }
      },
      "icon": "/drivers/v2c-wallbox/icon.svg",
      "images": {
        "small": "/drivers/v2c-wallbox/assets/images/small.png",
        "large": "/drivers/v2c-wallbox/assets/images/large.png",
        "xlarge": "/drivers/v2c-wallbox/assets/images/xlarge.png"
      },
      "pair": [
        {
          "id": "pair",
          "navigation": {
            "next": "list_my_devices"
          }
        },
        {
          "id": "list_my_devices",
          "template": "list_devices",
          "navigation": {
            "next": "add_my_devices",
            "prev": "pair"
          },
          "options": {
            "singular": true
          }
        },
        {
          "id": "add_my_devices",
          "template": "add_devices"
        }
      ],
      "settings": [
        {
          "id": "v2c_ip",
          "type": "text",
          "label": {
            "en": "V2C Wallbox IP"
          }
        },
        {
          "id": "update_interval",
          "type": "number",
          "label": {
            "en": "Pooling interval in sec (default is 5s)"
          },
          "hint": {
            "en": "Set the interval for data updates from the Wallbox."
          },
          "value": 5,
          "min": 1
        }
      ]
    }
  ],
  "capabilities": {
    "measure_dynamic": {
      "type": "boolean",
      "title": {
        "en": "Dynamic Mode"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/dynamic_mode.svg"
    },
    "measure_charge_energy": {
      "type": "number",
      "title": {
        "en": "Charged energy (kWh)"
      },
      "unit": "kWh",
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "decimals": 3,
      "icon": "/assets/charge_energy.svg"
    },
    "measure_charge_power": {
      "type": "number",
      "title": {
        "en": "Current charging power (W)"
      },
      "unit": "W",
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "decimals": 0,
      "icon": "/assets/charge_power.svg"
    },
    "measure_charge_state": {
      "type": "enum",
      "title": {
        "en": "Charger state"
      },
      "values": [
        {
          "id": "0",
          "title": {
            "en": "EV not connected"
          }
        },
        {
          "id": "1",
          "title": {
            "en": "EV connected"
          }
        },
        {
          "id": "2",
          "title": {
            "en": "Charging"
          }
        }
      ],
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/charge_state.svg"
    },
    "measure_charge_time": {
      "type": "number",
      "title": {
        "en": "Car connected (min)"
      },
      "unit": "min",
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "decimals": 2,
      "icon": "/assets/charge_time.svg"
    },
    "measure_intensity": {
      "type": "number",
      "title": {
        "en": "Intensity (A)"
      },
      "unit": "A",
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "decimals": 1,
      "icon": "/assets/intensity.svg"
    },
    "measure_locked": {
      "type": "boolean",
      "title": {
        "en": "Locked"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/locked.svg"
    },
    "measure_paused": {
      "type": "boolean",
      "title": {
        "en": "Paused"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/paused.svg"
    },
    "measure_slave_error": {
      "type": "enum",
      "title": {
        "en": "Communication Error"
      },
      "values": [
        {
          "id": "00",
          "title": {
            "en": "No Error"
          }
        },
        {
          "id": "01",
          "title": {
            "en": "Communication"
          }
        },
        {
          "id": "02",
          "title": {
            "en": "Reading"
          }
        },
        {
          "id": "03",
          "title": {
            "en": "Slave"
          }
        },
        {
          "id": "04",
          "title": {
            "en": "Waiting WiFi"
          }
        },
        {
          "id": "05",
          "title": {
            "en": "Waiting communication"
          }
        },
        {
          "id": "06",
          "title": {
            "en": "Wrong IP"
          }
        },
        {
          "id": "07",
          "title": {
            "en": "Slave not found"
          }
        },
        {
          "id": "08",
          "title": {
            "en": "Wrong Slave"
          }
        },
        {
          "id": "09",
          "title": {
            "en": "No response"
          }
        },
        {
          "id": "10",
          "title": {
            "en": "Clamp not connected"
          }
        }
      ],
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/slave_error.svg"
    },
    "measure_voltage_installation": {
      "type": "number",
      "title": {
        "en": "Installation voltage"
      },
      "unit": "V",
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "decimals": 0,
      "icon": "/assets/voltage_installation.svg"
    }
  }
}